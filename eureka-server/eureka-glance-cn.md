
## Eureka是什么?

Eureka是一种基于REST(Representational State Transfer)的服务，主要用于AWS(云服务平台)云中定位服务，以实现中间层服务器的负载平衡和故障转移。我们称这个服务为**Eureka服务器**。Eureka还附带了一个基于java的客户端组件，即**Eureka客户端**，这使得与服务的交互更加容易。客户端还有一个内置的负载均衡器，用于执行基本的循环负载均衡。在Netflix，一个更复杂的负载均衡器包装Eureka，提供基于流量、资源使用、错误条件等因素的加权负载均衡，以提供更好的弹性。

## 对Eureka的需求是什么?

在AWS云中，由于其固有特性，服务器来来去去。与传统的负载均衡器不同，在AWS中，负载平衡需要更复杂的注册和注销服务器的负载平衡器。由于AWS尚未提供中间层负载均衡器，Eureka填补了中间层负载均衡领域的巨大空白。

## 在Netflix中Eureka如何应用?

在Netflix, Eureka除了在中间层负载均衡中扮演关键角色之外，还用于以下目的。

*  用于使用Netflix [Asgard]的red/black部署一个使云部署更容易的开源服务。Eureka与Asgard交互，以便在较旧/更新的服务部署版本之间快速无缝地切换，以防出现问题——特别是考虑到要启动100个实例来部署一个版本可能需要很长时间。

* 对于我们的cassandra部署，以从流量中取出实例进行维护。

* 用于我们的memcached缓存服务，以识别环中的节点列表。

* 由于各种其他原因，用于携带关于服务的其他特定于应用程序的元数据。

## 何时应用Eureka呢? 

您通常在AWS云环境中运行，并且拥有许多中间层服务，您不希望向AWS ELB注册或公开来自外部世界的流量。您正在寻找一个简单的循环负载平衡解决方案，或者愿意根据负载平衡需要编写您自己的Eureka包装器。您不需要在外部缓存(如memcached)中加载会话和会话数据。更重要的是，如果您的架构适合支持基于客户端负载均衡器的模型，那么Eureka将非常适合这种使用。

## 客户端与服务端如何通信? 

通信技术可以是你喜欢的任何东西。Eureka帮助您找到关于您希望与之通信的服务的信息，但不对协议或通信方法施加任何限制。例如，您可以使用Eureka获取目标服务器地址，并使用协议，如thrift、http(s)或任何其他RPC机制。

## 高可用架构  

![Eureka High level Architecture](https://github.com/Netflix/eureka/raw/master/images/eureka_architecture.png)

上面的架构描述了如何在Netflix上部署Eureka，这是您通常运行它的方式。每个区域都有一个**eureka**集群，它只知道该区域的实例。每个区域至少有一个eureka服务器来处理区域故障。

服务注册到eureka，然后发送**心跳**以每30秒更新他们的租约。如果客户端不能续租几次，则在大约90秒内从服务器注册中心取出。注册信息和更新被复制到集群中的所有eureka节点。任何区域的客户端都可以查找**registry**信息(每30秒一次)来定位他们的服务(可以位于任何区域)并进行远程调用。

## 可配置性 

使用Eureka，您可以动态地添加或删除集群节点。您可以将内部配置从超时调优到线程池。Eureka使用[archaius](https://github.com/Netflix/archaius)，如果您有一个配置源实现，那么许多这些配置都可以动态调整。

## 弹性

身处AWS云中，我们很难不去考虑我们构建的每一件东西的弹性。Eureka从我们获得的经验中获益，它的弹性构建在客户端和服务器中。

Eureka客户端用于处理一个或多个Eureka服务器的故障。因为Eureka客户端中有注册表缓存信息，所以即使所有的Eureka服务器都宕机了，它们也可以很好地运行。

Eureka服务器对其他Eureka对等服务器具有抗跌能力。即使在客户机和服务器之间的网络分区中，服务器也具有内置的弹性，以防止大规模中断。


